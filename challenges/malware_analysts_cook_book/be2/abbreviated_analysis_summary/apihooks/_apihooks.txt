#########################################################################################################################################################################################################################################
# Investigation Details
# ======================
# Investigator Name: Solomon Sonya
# Investigation Description: Malware Analysis Cookbook - be2.vmem
# Investigation Date: 2022-01-18-1226:14
#
# Analysis Framework
# ======================
# Analysis Framework Name: Xavier Framework
# Analysis Framework Version: 2.114
#
# Memory Analysis Binary
# ======================
# File Name: vol_2.6.exe	 File Size: 15.79 MBs	 Creation Date: 2022-01-16-1019:29	 Last Accessed: 2022-01-18-1038:39	 Last Modified: 2021-02-28-2253:29	 
# MD5: 2fc05486a3fe93cef213cc37748bf556	 SHA-256: 672a00461ffb8d59536c86192450b66d552e67809fc8584d1792b42b22c5f4e1	 
#
# Analysis Image Details
# ======================
# Memory Image Path: C:\xavier\xavier_framework\import\memory_image\be2.vmem
# File Name: be2.vmem	 File Size: 134.22 MBs	 Creation Date: 2010-08-15-1622:24	 Last Accessed: 2022-01-18-1038:19	 Last Modified: 2010-08-15-1622:24	 
# MD5: 782bc4ae5d6b3a4e46b7d94c7c326d9b	 SHA-256: 50d9866adc908508c85517d2d1f55847ec52080b7244c13960a3ef9f4aa98c2a	 
#
# Plugin Details
# ======================
# Plugin Name: apihooks
# Plugin Description: Detect API hooks in process and kernel memory
#
# Execution Details
# ======================
# Execution Command: "C:\xavier\xavier_framework\import\memory_analysis\vol_2.6.exe" -f "C:\xavier\xavier_framework\import\memory_image\be2.vmem" apihooks --profile=WinXPSP2x86
#########################################################################################################################################################################################################################################


Volatility Foundation Volatility Framework 2.6
************************************************************************
Hook mode: Kernelmode
Hook type: Inline/Trampoline
Victim module: ntoskrnl.exe (0x804d7000 - 0x806cd280)
Function: ntoskrnl.exe!IofCompleteRequest at 0x804ede90
Hook address: 0xff0d1c2d
Hooking module: 00004A2A

Disassembly(0):
0x804ede90 ff2504b45480     JMP DWORD [0x8054b404]
0x804ede96 cc               INT 3
0x804ede97 cc               INT 3
0x804ede98 cc               INT 3
0x804ede99 cc               INT 3
0x804ede9a cc               INT 3
0x804ede9b cc               INT 3
0x804ede9c 8bff             MOV EDI, EDI
0x804ede9e 55               PUSH EBP
0x804ede9f 8bec             MOV EBP, ESP
0x804edea1 56               PUSH ESI
0x804edea2 ff1514774d80     CALL DWORD [0x804d7714]

Disassembly(1):
0xff0d1c2d 6a2c             PUSH 0x2c
0xff0d1c2f 6818470dff       PUSH DWORD 0xff0d4718
0xff0d1c34 e8b7290000       CALL 0xff0d45f0
0xff0d1c39 8855e4           MOV [EBP-0x1c], DL
0xff0d1c3c 8bd9             MOV EBX, ECX
0xff0d1c3e 895dd4           MOV [EBP-0x2c], EBX
0xff0d1c41 8b7360           MOV ESI, [EBX+0x60]
0xff0d1c44 80               DB 0x80

